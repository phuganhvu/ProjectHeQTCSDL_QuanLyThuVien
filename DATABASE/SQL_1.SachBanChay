SELECT TOP 10 
    YEAR(DH.NgayDat) AS Nam,
    MONTH(DH.NgayDat) AS Thang,
    S.TenSach,
    SUM(CT.SoLuong) AS TongSoLuongBan
FROM DonHang DH
JOIN ChiTietDH CT ON DH.SoDH = CT.SoDH
JOIN Sach S ON CT.MaSach = S.MaSach
GROUP BY YEAR(DH.NgayDat), MONTH(DH.NgayDat), S.TenSach
ORDER BY TongSoLuongBan DESC, Nam DESC, Thang DESC;
