SELECT
    S.TenSach,
    SUM(CT.SoLuong * CT.DonGia) AS TongDoanhThu
FROM ChiTietDH CT
JOIN Sach S ON CT.MaSach = S.MaSach
GROUP BY S.TenSach
ORDER BY TongDoanhThu DESC;
